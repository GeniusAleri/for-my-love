<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Letters from the Stars â€” Envelope</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Quicksand:wght@300;400&display=swap"
    rel="stylesheet">
  <style>
    :root {
      --bg-top: #0b2340;
      /* blue dark */
      --bg-bottom: #3b1b5b;
      /* purple */
      --accent: rgba(255, 255, 255, 0.95);
      --soft: rgba(255, 255, 255, 0.85);
    }

    * {
      box-sizing: border-box
    }

    html,
    body {
      height: 100%;
      margin: 0;
      font-family: "Quicksand", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      color: var(--accent);
      background: linear-gradient(180deg, var(--bg-top) 0%, var(--bg-bottom) 100%);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow: hidden;
    }

    /* Opening screen */
    #opening {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 20;
      background: linear-gradient(180deg, rgba(11, 35, 64, 0.25), rgba(59, 27, 91, 0.12));
      transition: opacity .9s ease;
    }

    #opening h1 {
      font-family: "Playfair Display", serif;
      font-weight: 600;
      margin-bottom: 12px;
      color: var(--soft);
      text-shadow: 0 6px 18px rgba(0, 0, 0, 0.45);
      letter-spacing: 0.6px;
    }

    #opening p {
      margin: 8px 0 24px;
      color: rgba(255, 255, 255, 0.8)
    }

    .btn {
      appearance: none;
      border: 0;
      margin-top: 90px;
      padding: 14px 28px;
      border-radius: 28px;
      cursor: pointer;
      background: linear-gradient(90deg, #6b3eb0, #3b7bd3);
      color: white;
      font-weight: 600;
      box-shadow: 0 8px 30px rgba(59, 27, 91, 0.35);
      transform: translateZ(0);
    }

    .btn:hover {
      transform: translateY(-4px) scale(1.02)
    }

    /* Canvas stars in background */
    #starfield {
      position: fixed;
      inset: 0;
      z-index: 0;
      display: block;
      background: transparent;
    }

    /* subtle fog */
    .fog {
      position: fixed;
      inset: 0;
      z-index: 1;
      pointer-events: none;
      background: radial-gradient(60% 40% at 20% 20%, rgba(255, 255, 255, 0.02), transparent 15%),
        radial-gradient(50% 35% at 80% 70%, rgba(255, 255, 255, 0.02), transparent 20%);
      mix-blend-mode: overlay;
    }

    /* Envelope wrapper center */
    .stage {
      position: relative;
      z-index: 10;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: none;
    }

    /* Envelope */
    .envelope {
      width: 320px;
      height: 210px;
      position: relative;
      perspective: 1000px;
      pointer-events: auto;
      /* allow button area */
    }

    .env-body {
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.98), rgba(250, 250, 250, 0.95));
      border-radius: 10px;
      box-shadow: 0 15px 40px rgba(3, 6, 20, 0.6), 0 2px 6px rgba(0, 0, 0, 0.4);
      transform-origin: top center;
      transform: translateY(-12px) scale(0.98);
      overflow: hidden;
    }

    /* flap */
    .env-flap {
      position: absolute;
      left: 0;
      right: 0;
      top: -4px;
      height: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      transform-origin: top center;
      transform: rotateX(0deg);
      transition: transform .9s cubic-bezier(.2, .9, .3, 1);
    }

    .env-flap::before {
      content: "";
      display: block;
      width: 100%;
      height: 120px;
      background: linear-gradient(180deg, rgba(120, 78, 170, 0.95), rgba(90, 58, 140, 0.95));
      clip-path: polygon(50% 0, 100% 40%, 100% 100%, 0 100%, 0 40%);
      border-radius: 10px;
      box-shadow: inset 0 -6px 12px rgba(0, 0, 0, 0.15), 0 12px 30px rgba(59, 27, 91, 0.28);
    }

    /* seal */
    .seal {
      position: absolute;
      left: 50%;
      top: 36%;
      transform: translateX(-50%);
      width: 58px;
      height: 58px;
      border-radius: 50%;
      background: radial-gradient(circle at 35% 30%, #ffd9f4, #ffd9f4 5%, #ff8fc7 60%);
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.35);
      z-index: 5;
      opacity: 0.95;
    }

    /* Letter inside */
    .letter {
      position: absolute;
      left: 8%;
      right: 8%;
      top: 20px;
      bottom: 10px;
      background: transparent;
      padding: 18px 20px;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      flex-direction: column;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity .9s ease, transform .9s ease;
      pointer-events: none;
    }

    .letter .title {
      font-family: "Playfair Display", serif;
      font-size: 1.15rem;
      color: #2a1b3f;
      margin-bottom: 8px
    }

    .letter .excerpt {
      font-size: 0.95rem;
      color: #333;
      white-space: pre-line;
      line-height: 1.6;
      font-weight: 400
    }

    /* after opened, we show content area */
    #content {
      position: relative;
      z-index: 12;
      display: none;
      width: 86%;
      max-width: 820px;
      margin: 40px auto;
      background: rgba(255, 255, 255, 0.06);
      border-radius: 12px;
      padding: 28px;
      backdrop-filter: blur(6px);
      box-shadow: 0 10px 30px rgba(2, 6, 20, 0.55);
      max-height: 74vh;
      overflow-y: auto;
      color: var(--accent);
    }

    #content h2 {
      font-family: "Playfair Display", serif;
      margin: 0 0 12px;
      color: #fff
    }

    #content p {
      color: rgba(255, 255, 255, 0.95);
      line-height: 1.8;
      white-space: pre-line;
      font-size: 1rem
    }

    /* helper */
    .center-cta {
      position: absolute;
      bottom: 18px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 15;
      pointer-events: auto
    }

    .small-muted {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.7);
      margin-top: 10px
    }

    /* animations when triggered */
    .drop-in {
      animation: dropIn 1.1s cubic-bezier(.2, .9, .3, 1) forwards;
    }

    @keyframes dropIn {
      0% {
        transform: translateY(-40vh) rotate(-6deg) scale(.9);
        opacity: 0
      }

      60% {
        transform: translateY(2vh) rotate(2deg) scale(1.03);
        opacity: 1
      }

      100% {
        transform: translateY(0) rotate(0deg) scale(1);
      }
    }

    .flap-open {
      transform: rotateX(180deg) translateY(-8px) !important;
      transition: transform .9s cubic-bezier(.2, .9, .3, 1) .3s;
    }

    .env-body-open {
      transform: translateY(0) scale(1) !important;
      transition: transform .9s cubic-bezier(.2, .9, .3, 1);
    }

    .letter-show {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
      transition-delay: .4s
    }

    /* subtle scrollbar */
    #content::-webkit-scrollbar {
      width: 8px
    }

    #content::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.12);
      border-radius: 8px
    }

    @media (max-width:420px) {
      .envelope {
        width: 260px;
        height: 170px
      }

      .letter {
        top: 18px
      }

      #content {
        width: 92%
      }
    }
  </style>
</head>

<body>

  <!-- star canvas -->
  <canvas id="starfield"></canvas>
  <div class="fog"></div>

  <!-- Opening -->
  <div id="opening">
    <button class="btn" id="openBtn">Buka Surat ðŸŒ™</button>
  </div>

  <!-- center stage -->
  <div class="stage" aria-hidden="true">
    <div class="envelope" id="envelope" title="Amplop">
      <div class="env-flap" id="flap"></div>
      <div class="env-body" id="body">
        <div class="seal" id="seal"></div>
        <div class="letter" id="letter">
          <div class="title">Untuk Kamu...</div>
          <div class="excerpt" id="excerpt">...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- content area (scrollable) -->
  <div id="content" aria-live="polite">
    <h2>Suratku untukmu</h2>
    <p id="fullTextHere"></p>
  </div>

  <!-- audio -->
  <audio id="bgMusic"
    src="Garam & Madu - Tenxi & Naykilla & Jemsii  Mix Lirik - Zia & Mikky, Putri Tanjung & Mario G Klau.mp3"
    preload="auto"></audio>

  <script>
    // --------------------------
    // STARFIELD (calm minimal)
    // --------------------------
    const canvas = document.getElementById('starfield');
    const ctx = canvas.getContext('2d');
    let w = canvas.width = innerWidth;
    let h = canvas.height = innerHeight;
    window.addEventListener('resize', () => {
      w = canvas.width = innerWidth; h = canvas.height = innerHeight;
      initStars();
    });

    let stars = [];
    function initStars() {
      stars = [];
      const count = Math.floor((w * h) / 6000); // keep it calm
      for (let i = 0; i < count; i++) {
        stars.push({
          x: Math.random() * w,
          y: Math.random() * h,
          r: Math.random() * 1.6 + 0.4,
          tw: Math.random() * 1.6 + 0.6,
          off: Math.random() * 1000
        });
      }
    }
    initStars();

    function drawStars(t) {
      ctx.clearRect(0, 0, w, h);
      // subtle gradient overlay
      const g = ctx.createLinearGradient(0, 0, 0, h);
      g.addColorStop(0, 'rgba(255,255,255,0.02)');
      g.addColorStop(1, 'rgba(0,0,0,0.02)');
      ctx.fillStyle = g;
      ctx.fillRect(0, 0, w, h);

      for (const s of stars) {
        const twinkle = 0.6 + 0.4 * Math.sin((t / 1000) / s.tw + s.off);
        ctx.beginPath();
        ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
        ctx.fillStyle = `rgba(255,255,255,${0.6 * twinkle})`;
        ctx.fill();
      }
      requestAnimationFrame(drawStars);
    }
    requestAnimationFrame(drawStars);

    // occasional small shooting star
    function createShooting() {
      const x = Math.random() * w * 0.7 + w * 0.1;
      const y = Math.random() * h * 0.35 + 20;
      const len = Math.random() * 140 + 80;
      const grad = ctx.createLinearGradient(x, y, x + len, y + len);
      grad.addColorStop(0, 'rgba(255,255,255,0.95)');
      grad.addColorStop(1, 'rgba(255,255,255,0)');
      let start = performance.now();
      function animate(now) {
        const prog = (now - start) / 900; // 0..1
        if (prog > 1) return;
        // draw a single frame of shooting star on overlay canvas effect by drawing to ctx BUT we avoid clearing global draw, so instead create ephemeral canvas
        const tmp = document.createElement('canvas'); tmp.width = w; tmp.height = h;
        const tctx = tmp.getContext('2d');
        tctx.globalCompositeOperation = 'lighter';
        tctx.beginPath();
        tctx.moveTo(x, y);
        tctx.lineTo(x + len * prog, y + len * prog);
        tctx.lineWidth = 2;
        tctx.strokeStyle = grad;
        tctx.stroke();
        // composite into main canvas with slight glow
        ctx.save();
        ctx.globalAlpha = 1 - prog;
        ctx.drawImage(tmp, 0, 0);
        ctx.restore();
        requestAnimationFrame(animate);
      }
      requestAnimationFrame(animate);
    }
    setInterval(() => { if (Math.random() < 0.55) createShooting(); }, 5200);

    // --------------------------
    // ENVELOPE ANIMATION & LOGIC
    // --------------------------
    const openBtn = document.getElementById('openBtn');
    const envelope = document.getElementById('envelope');
    const flap = document.getElementById('flap');
    const bodyEnv = document.getElementById('body');
    const seal = document.getElementById('seal');
    const letter = document.getElementById('letter');
    const excerpt = document.getElementById('excerpt');
    const content = document.getElementById('content');
    const fullTextNode = document.getElementById('fullTextHere');
    const music = document.getElementById('bgMusic');

    // sample excerpt short while open (kept elegant)
    excerpt.textContent = "Sebuah surat dari langit malam... ðŸ‘‡";

    // the full text - replace with your long message (use backticks to preserve newlines)
    const fullText = `Malam ini, aku duduk menatap langit yang tenang. Bintang-bintang nya seperti berbisik, dan aku merasa ingin mengirim sedikit kata untukmu.

Kau selalu hadir dalam tiap detik yang sunyi. Jarak mungkin menjauhkan raga, tapi tak pernah mengurangi hangatnya yang kau bawa.

Terima kasih sudah menjadi alasan senyumku. Ini hanya sebait kata, tapi kuberharap ia sampai hangat ke hatimu.

Maaf yaa sayangg huhuhuuhu kali ini gpt, akuu gatauu mau nuliss apalagii hehehehe, yang pastii tetepp, Love u babyyðŸ’•
`;

    // typing into content area (scrollable)
    function typeIntoContent(text, speed = 28) {
      fullTextNode.textContent = ""; // clear
      let k = 0;
      content.scrollTop = 0;
      const timer = setInterval(() => {
        fullTextNode.textContent += text.charAt(k);
        k++;
        // auto scroll to bottom so user sees progress
        content.scrollTop = content.scrollHeight;
        if (k >= text.length) {
          clearInterval(timer);
          // remove caret if any
        }
      }, speed);
    }

    // when open clicked
    openBtn.addEventListener('click', async () => {
      // ensure opening button is hidden elegantly
      document.getElementById('opening').style.opacity = 0;
      setTimeout(() => { document.getElementById('opening').style.display = 'none'; }, 700);

      // animate envelope drop-in
      envelope.classList.add('drop-in');

      // allow interactions (pointer events) for envelope to open
      envelope.style.pointerEvents = 'auto';

      // small delay then open flap automatically
      setTimeout(() => {
        flap.classList.add('flap-open');
        bodyEnv.classList.add('env-body-open');
        // fade seal
        seal.style.transform = 'scale(.85) translateY(-6px)';
        seal.style.opacity = '0.0';
      }, 1200);

      // show the letter content inside envelope briefly
      setTimeout(() => {
        letter.classList.add('letter-show');
      }, 1700);

      // after letter revealed, reveal content area & play music & type
      setTimeout(() => {
        // show content area
        content.style.display = 'block';
        // allow page scroll
        document.documentElement.style.overflow = 'auto';
        document.body.style.overflow = 'auto';
        // auto play music (user initiated click occurred)
        music.currentTime = 0;
        music.play().catch(() => {/* some browsers may still block but usually OK since triggered by click */ });
        // type the full message in the scrollable content
        typeIntoContent(fullText, 24);
        // smooth scroll to content
        setTimeout(() => { content.scrollIntoView({ behavior: 'smooth', block: 'center' }); }, 80);
      }, 2400);
    });

    // small accessibility: pressing Enter or Space when openBtn focused works
    openBtn.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') openBtn.click(); });

  </script>
</body>

</html>